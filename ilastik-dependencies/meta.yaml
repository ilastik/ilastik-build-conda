{% if not WITH_SOLVERS is defined %}
  {% set WITH_SOLVERS = 1 %}
{% endif %}
{% set WITH_SOLVERS = WITH_SOLVERS|int %}

package:
  {% if WITH_SOLVERS %}
    name: ilastik-dependencies
  {% else %}
    name: ilastik-dependencies-no-solvers
  {% endif %}
    version: 1.3.3

build:
  number: 1000
  track_features:
    # on osx we need to make sure that we install the numpy versions with openblas instead of mkl to prevent clashes with cplex
    - blas_openblas #[osx] 
#
# In general, we don't specify exact version requirements in each sub-package.
# But this file tracks the versions of all packages used in the release.
requirements:
  run:
    # -----------------------------------------------------------------
    # General dependencies
    # -----------------------------------------------------------------
    - python                    {{ python }}
    - numpy                     {{ numpy }}

    - decorator                 
    - fftw                      
    - future                   
    - greenlet                  
    - h5py                      {{ h5py }}
    - hdf5                      {{ hdf5 }}
    - jsonschema                
    - networkx                  {{ networkx }}      # TODO API change in 2.0
    - nose
    - pillow                    {{ pillow }}
    - pytest                    {{ pytest }}
    - psutil                    
    - pyqt                      {{ pyqt }}
    - pyqtgraph
    - pyopengl
    - python-dateutil                
    - pytz                      
    - qimage2ndarray            
    - qt                        {{ qt }}
    - readline                                 # [not win]
    - requests
    - scikit-image
    # need to specify version on windows, due to
    # RuntimeError: module compiled against API version 0xc but this version of numpy is 0xa
    - scikit-image              {{ skimage }}*  # [win]
    - scikit-learn              {{ sklearn }}*
    - setuptools                
    - matplotlib
    - mkl                       {{ mkl }}      # [win]
    
    # -----------------------------------------------------------------
    # packages built by us
    # -----------------------------------------------------------------
    - fastfilters
    - pytiff
    - tifffile                  {{ tifffile }}
    - yapsy                     
    - lemon    

    # -----------------------------------------------------------------
    # ilastik main packages developed by us
    # -----------------------------------------------------------------
    - ilastik-feature-selection 
    - ilastiktools              
    - ilastikrag                
    - wsdt
    - marching_cubes
    - numpy-allocation-tracking
    - vigra                     {{ vigra }}
    - ilastik-meta
    - ilastik-launch                           # [not win]

    # -----------------------------------------------------------------
    # Trackinghdf5
    # -----------------------------------------------------------------
    - dpct                      
    - hytra
    - mamutexport               

{% if WITH_SOLVERS %}
    - multi-hypotheses-tracking-with-gurobi
    - multi-hypotheses-tracking-with-cplex
{% endif %}

    
    # -----------------------------------------------------------------
    # Multicut
    # -----------------------------------------------------------------
    - nifty                     
    

test:
  # Just give SOME test to ensure that the package can be installed at all.
  # (If there are no tests, the test environment isn't even created.)
  imports:
    - vigra

about:
  home: https://github.com/ilastik-build-conda
  license: BSD (3-clause)
  summary: 'Package for all dependencies needed to run ilastik'
